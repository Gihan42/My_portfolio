<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>pos system item page</title>
    <meta content="width=device-width, initial-scale=1" name="viewport">
    <link rel="icon" type="image/x-icon" href="../assests/pos_img/external-Products-grocery-flat-berkahicon.png"  >
    <!-- <link rel="stylesheet" href="/assets/fonts/css/all.min.css"> -->
    <!--link Bootstrap Framework-->
    <link href="../assests/css/bootstrap.min.css" rel="stylesheet">
   <style>
    * {
    margin:0;
    padding:0;
    box-sizing: border-box;
    text-decoration: none;
}
body{
  background-color: white;
}
    .blockquote{
        margin: 40px;
    }
    .card{
        border: 1px solid;
        padding: 10px;
        box-shadow: 5px 10px #dcdadaf2;
        margin: 5px;
        background-color: rgb(237, 239, 240);
    }
    .card-2{
        border: 1px solid;
        padding: 10px;
        box-shadow: 5px 10px #dcdadaf2;
        margin: 0px;
        margin-bottom: 20px;
        background-color: rgb(237, 239, 240);
    }
    .card:hover{
        border: 1px solid rgb(21, 153, 255);
        height: 200px;
        width: 400px;
    }
    .nav-item > a:hover {
        color: rgb(255, 255, 255);
    }
    .row{
      margin-bottom: 5px;
    }
    table{
      height: 180px;
    }
    button{
      margin: 5px;
    }
    .item{
        margin-top: 80px;
    }
   </style>
</head>
<body>
<!-- navbar -->
<nav class="navbar navbar-expand-lg fixed-top" style="background-color: #a9ff46;">
    <div class="container-fluid">
      <a class="navbar-brand" href="#" style="color: rgb(116, 4, 4); font-size: 25px;">  <img src="/assigmnent/css/frameworks/assests/pos_img/external-Products-grocery-flat-berkahicon.png" alt="cart" width="35" height="28" style="margin: 5px;" >products</a>
      <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarScroll" aria-controls="navbarScroll" aria-expanded="false" aria-label="Toggle navigation">
        <span class="navbar-toggler-icon"></span>
      </button>
      <div class="collapse navbar-collapse" id="navbarScroll">
        <ul class="navbar-nav me-auto my-2 my-lg-0 navbar-nav-scroll" style="--bs-scroll-height: 100px;">
            <li class="nav-item">
                <a class="nav-link active" aria-current="page" href="../index.html">Home</a>
              </li>
              <li class="nav-item">
                <a class="nav-link" href="customer.html" >customer</a>
              </li>
              <li class="nav-item">
                <a class="nav-link" href="item.html">products</a>
              </li>
              <li class="nav-item">
                <a class="nav-link" href="order.html">orders</a>
              </li>
              <li class="nav-item">
                <a class="nav-link" href="#"><i class="fa-sharp fa-solid fa-moon"></i></a>
              </li>
        </ul>
        <form class="d-flex" role="search">
          <input class="form-control me-2" type="search" placeholder="Search" aria-label="Search">
          <button class="btn btn-outline-success" type="submit">Search</button>
        </form>
      </div>
    </div>
  </nav>

  <!-- item form -->
<section id="item" class="item">
    <span class="d-block p-2 text-bg-primary" >products form</span><br>
    <!--Nav bar ends-->
    <section class="row container-fluid"> <!--row-->
        <section class="col"> <!--col 1-->
            <!--form starts here-->
            <div class="form-floating mb-3">
                <input type="email" class="form-control" placeholder="name@example.com" id="item-search">
                <label for="floatingInput"> ID / CODE</label>
            </div>
            <!--form ends here-->
        </section>
        <section class="col"><!--col-2-->
          <button type="button" class="btn btn-secondary" data-bs-target="#exampleModal0" data-bs-toggle="modal" type="button" id="loadForm">load item details</button>
          <button class="btn btn-danger" data-bs-target="#exampleModal0" data-bs-toggle="modal" type="button">
            + add new item
        </button>
        <!-- new item -->
        <div aria-hidden="true" aria-labelledby="exampleModalLabel" class="modal fade" id="exampleModal0" tabindex="-1" >
          <div class="modal-dialog">
              <div class="modal-content">
                  <div class="modal-header" style="background-color: #46b2ff;">
                      <h5 class="modal-title" id="exampleModalLabel"> save item</h5>
                      <button aria-label="Close" class="btn-close" data-bs-dismiss="modal" type="button"></button>
                  </div>
                  <div class="modal-body">
                      <section>
                          <div class="mb-3">
                              <label class="form-label" for="formFile"> item code</label>
                              <input class="form-control" id="txtItemcode" type="text">
                          </div>
                          <div class="mb-3">
                              <label class="form-label" for="formFileMultiple">item name</label>
                              <input class="form-control" id="txtItemName"  type="text">
                          </div>
                          <div class="mb-3">
                              <label class="form-label" for="formFileDisabled">item price</label>
                              <input class="form-control" id="txtItemPrice" type="number">
                          </div>
                          <div class="mb-3">
                              <label class="form-label" for="formFileSm">itemquantity</label>
                              <input class="form-control form-control-sm" id="txtitemQty" type="number">
                          </div>
      
                          <div aria-label="Basic mixed styles example" class="btn-group" role="group">
                              <button class="btn btn-danger" type="button" id="delet-item">item Delete</button>
                              <button class="btn btn-warning" type="button" id="update-item">Update</button>
                              <button class="btn btn-success" type="button" id="save-item">Save</button>
                              <button class="btn btn-info " type="button" id="getAll-iteam">Get-All</button>

                          </div>
                      </section>
                  </div>
                  <div class="modal-footer">
                      <button class="btn btn-secondary" data-bs-dismiss="modal" type="button">Close</button>
                      <button class="btn btn-primary" type="button">Save changes</button>
                  </div>
              </div>
          </div>
      </div>
      
    </section>
    <section class="row"><!--col-2-->
        <section class="col"><!--col-2-->
          <button class="btn btn-outline-success" data-bs-target="#exampleModal0" data-bs-toggle="modal" type="button" id="search">ðŸ”Ž Search</button>
            <select class="fctorm-sele" name="names" id="name" style="width: 250px; height: 38px; border: 1px solid black; border-radius: 8px; " >
            </select>
    </section><br><br><br>
    <section class="row"><!--col-2-->
        <section class="col"><!--col-2-->
            <button type="button" class="btn btn-dark" id="deleteItem">Delete</button>
            <button type="button" class="btn btn-danger">Details</button>
            <button type="button" class="btn btn-warning">Clear</button>
            </select>
    </section>
  </section>
        </section>
    </section>
    <!--Table contents starts from here-->
    <table class="table table-warning" id="iteam-table">
        <thead>
        <tr>
            <th scope="col">code</th>
            <th scope="col">name</th>
            <th scope="col">price rs.</th>
            <th scope="col">quantity</th>
        </tr>
        </thead>
        <tbody id="iteam-tablebody">
     
        </tbody>
    </table>
    
  <!-- order form -->
  </section>
  <script src="../assests/js/bootstrap.min.js"></script>
  <script src="https://code.jquery.com/jquery-3.6.1.min.js" integrity="sha256-o88AwQnZB+VDvE9tvIXrMQaPlFFSUTR+nldQm1LuPXQ=" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11.4.34/dist/sweetalert2.all.min.js"></script>
  <script>
    var itemsArray=[];
    $('#save-item').click(function(){
      saveItem();
      getAllItem();
      loadDetails();
      clear()
})
function saveItem(){
  Swal.fire({
        position: 'center',
        icon: 'success',
        title: 'Your item has been saved',
        showConfirmButton: false,
        timer: 1500
})
      let itemcode= $('#txtItemcode').val();
      let itemName= $('#txtItemName').val();
      let itemPrice= $('#txtItemPrice').val();
      let itemqty= $('#txtitemQty').val();

      var item={
        itemcode,
        itemName,
        itemPrice,
        itemqty
      }
      itemsArray.push(item)
      console.log(itemsArray)
}
    $('#getAll-iteam').click(function(){
      getAllItem();
    })
    function getAllItem(){
      $('#iteam-tablebody').empty();
      for(var i of itemsArray ){
      var row=`<tr ><td>${i.itemcode}</td><td >${ i.itemName}</td> <td >${i.itemPrice}</td><td >${i.itemqty}</td></tr>`;
      $('#iteam-tablebody').append(row)
    }
    clear()
  }
  // SEARCH ITEM
  // function findItem(){
  //   var result=$('#item-search').val();
  //   for (var i of itemsArray){
  //     if(i.itemcode == result){
  //       $('#txtItemcode').val(i.itemcode)
  //       $('#txtItemName').val(i.itemName)
  //       $('#txtItemPrice').val(i.itemPrice)
  //       $('#txtitemQty').val(i.itemqty)
  //     }
  //   }
  // }
  function searchItem(itemCode){
      for (let item of itemsArray) {
        if(item.itemcode==itemCode){
            return item;
        }
      }
      return null;
  }
$('#search').click(function(){
  let typecode=$('#item-search').val();
  let item=searchItem(typecode)
  if(item !=null){
    $('#txtItemcode').val(item.itemcode)
    $('#txtItemName').val(item.itemName)
    $('#txtItemPrice').val(item.itemPrice)
    $('#txtitemQty').val(item.itemqty)
  }
  else {
        Swal.fire("There is no item available for that " + typecode)
        }
})
$('#txtItemcode').change(function(){
findItem()
})
  function clear(){
    $('#txtItemcode').val('')
    $('#txtItemName').val('')
    $('#txtItemPrice').val('')
    $('#txtitemQty').val('')
  }
  //////////// end find item ///////////

  ////ITEM DELETE /////
  $('#delet-item').click(function(){
    let iCode=$('#item-search').val();
    let option=confirm('Do you want to delete this item'+iCode)
    if(option){
    if(deletItem(iCode)){
      Swal.fire({
        icon: 'delete',
        title: 'Deleted...',
        text: 'Item Successfully Deleted!',
})
  $('#txtcustomerId').val('')
  $('#txtcustomerName').val('')
  $('#txtcustomerAddress').val('')
  $('#txtcustomerSalary').val('')

    }
    else{
  Swal.fire("No such item to delete. please check the id" )
}
    }
  })
  function deletItem(itemcode){
    let item=searchItem(itemcode)
    if(item!=null){
        let indexNo=itemsArray.indexOf(item)
        itemsArray.splice(indexNo,1)
        getAllItem();
        return true;
    }
    else{
      return false;
    }

  }

  ///END ITEM DELETE////
  ///UPDATE ITEM////
  $('#update-item').click(function(){
    let itemCode=$('#txtItemcode').val()
    let response=updateItem(itemCode)
    if(response){
      Swal.fire({
  position: 'center',
  icon: 'success',
  title: 'Customer Updated Successfully',
  showConfirmButton: false,
  timer: 1500
})
$('#txtItemcode').val('')
$('#txtItemName').val('')
$('#txtItemPrice').val('')
$('#txtitemQty').val('')
    }
    else{
      Swal.fire("Update Failed..!" )
    }
  })
  function updateItem(itemCode){
    let item=searchItem(itemCode)
    if(item != null){
      item.itemCode=$('#txtItemcode').val()
      item.itemName= $('#txtItemName').val()
      item.itemPrice= $('#txtItemPrice').val()
      item.itemqty=$('#txtitemQty').val()
      getAllItem()
      return true
    }
    else{
      return false
    }
  }
  ///DELETE ITEM///
  //CLICK ROW AND SET VALUES TEXT FEILD/////
$('#loadForm').click(function(){
  loadDetails()
})
function loadDetails(){
  $("#iteam-tablebody>tr").click(function(){
    let code=$(this).children(':eq(0)').text()
    let name=$(this).children(':eq(1)').text()
    let price=$(this).children(':eq(2)').text()
    let qty=$(this).children(':eq(3)').text()

    $('#txtItemcode').val(code)
    $('#txtItemName').val(name)
    $('#txtItemPrice').val(price)
    $('#txtitemQty').val(qty)
  })
}
///ENTER EVENT  SAVE ITEM  & VALIDATION///
$('#txtItemcode').on('keydown',function(event){
  if(event.key=='Enter'){
    var code=/^(I)[0-9]{3}$/;
    var result=code.test($('#txtItemcode').val());
    if(result){
      $("#txtItemcode").css({
        'border-color': 'green'
      })
      $('#txtItemName').focus();
    }
    else{
      $("#txtItemcode").css({
        'border-color': 'red'
      })
    }
  }
})
$('#txtItemName').on('keydown',function(event){
  if(event.key=='Enter'){
    var Name=/^[A-z ]{3,15}$/
    var result=Name.test($('#txtItemName').val());
    if(result){
      $("#txtItemName").css({
        'border-color': 'green'
      })
      $('#txtItemPrice').focus();
    }
    else{
      $("#txtItemName").css({
        'border-color': 'red'
      })
    }
    
  }
})
$('#txtItemPrice').on('keydown',function(event){
  if(event.key=='Enter'){
    var price=/^[1-9][0-9]*(.[0-9]{2})?$/;
    var result=price.test($('#txtItemPrice').val());
    if(result){
      $("#txtItemPrice").css({
        'border-color': 'green'
      })
      $('#txtitemQty').focus();
    }
    else{
      $("#txtItemPrice").css({
        'border-color': 'red'
      })
    }
  }
})
$('#txtitemQty').on('keydown',function(event){
  if(event.key=='Enter'){
    var qty=/^[0-9]{1,}$/;
    var result=qty.test($('#txtitemQty').val());
    if(result){
      $("#txtitemQty").css({
        'border-color': 'green'
      })
    confirm('Do you want to save this item');
    saveItem();
    getAllItem();
    }
    else{
      $("#txtitemQty").css({
        'border-color': 'red'
      })
    }
    
  }
})
////disable tab key of all  text fields
$('#txtItemcode,#txtItemName,#txtItemPrice,#txtitemQty').on('keydown',function(event){
     if(event.key=='Tab'){
      event.preventDefault();
     }
})
/////END ENTER EVENT & SAVE ITEM/////
  </script>
</body>
</html>